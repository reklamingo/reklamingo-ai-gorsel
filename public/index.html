<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reklamingo Görsel Oluşturucu</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #003e92;
            --secondary: #3ecf00;
        }
        body {
            font-family: 'Quicksand', sans-serif;
            background-color: #f8f9fa;
        }
        .canvas-container {
            position: relative;
            overflow: hidden;
            background-color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .canvas-frame {
            position: absolute;
            pointer-events: none;
            box-sizing: border-box;
        }
        .logo-container {
            position: absolute;
            cursor: move;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .color-option:hover {
            transform: scale(1.1);
        }
        .gradient-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .gradient-option:hover {
            transform: scale(1.1);
        }
        .btn-primary {
            background-color: var(--primary);
            color: white;
            transition: all 0.3s;
        }
        .btn-primary:hover {
            background-color: #002d6b;
        }
        .btn-secondary {
            background-color: var(--secondary);
            color: white;
            transition: all 0.3s;
        }
        .btn-secondary:hover {
            background-color: #2da000;
        }
        .tab-active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: 600;
        }
        input[type="range"] {
            -webkit-appearance: none;
            height: 8px;
            border-radius: 4px;
            background: #e2e8f0;
            outline: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
        }
        .usage-limit {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 62, 146, 0.9);
            color: white;
            text-align: center;
            padding: 10px;
            font-size: 14px;
            z-index: 1000;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1050;
            overflow: auto;
        }
        .modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 20px;
            border-radius: 8px;
            max-width: 500px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close:hover {
            color: #333;
        }
        .logo-alignment {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
        }
        .align-btn {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        .align-btn:hover {
            background-color: #f0f0f0;
        }
        .align-btn.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        #download-progress {
            display: none;
            margin-top: 10px;
            text-align: center;
        }
        .progress-bar {
            width: 100%;
            background-color: #e2e8f0;
            border-radius: 4px;
            height: 10px;
            margin-top: 5px;
            overflow: hidden;
        }
        .progress-bar-fill {
            height: 100%;
            background-color: var(--secondary);
            width: 0%;
            transition: width 0.3s;
        }
        #preview-image {
            max-width: 100%;
            max-height: 80vh;
            display: block;
            margin: 0 auto;
        }
        .preview-modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 8px;
            max-width: 80%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Kod Giriş Modalı -->
    <div id="code-modal" class="modal">
        <div class="modal-content">
            <span class="close" id="close-code-modal">&times;</span>
            <h2 class="text-2xl font-bold mb-4" style="color: var(--primary);">Aktivasyon Kodu Girin</h2>
            <p class="mb-4">Görsel oluşturucuyu kullanmak için aktivasyon kodunuzu girin.</p>
            <div class="mb-4">
                <input type="text" id="activation-code" class="w-full p-3 border rounded" placeholder="Aktivasyon kodunuz">
            </div>
            <div class="flex justify-between">
                <button id="verify-code" class="btn-primary py-2 px-6 rounded">Doğrula</button>
                <button id="cancel-code" class="bg-gray-300 py-2 px-6 rounded">İptal</button>
            </div>
            <div id="code-message" class="mt-3 text-center hidden"></div>
        </div>
    </div>

    <!-- Önizleme Modalı -->
    <div id="preview-modal" class="modal">
        <div class="preview-modal-content">
            <span class="close" id="close-preview-modal">&times;</span>
            <h2 class="text-2xl font-bold mb-4" style="color: var(--primary);">Görseliniz Hazır</h2>
            <img id="preview-image" src="" alt="Oluşturulan görsel">
            <div class="mt-4">
                <p class="mb-2">Görseli indirmek için:</p>
                <ol class="text-left mb-4 ml-6 list-decimal">
                    <li>Görsele sağ tıklayın</li>
                    <li>"Resmi Farklı Kaydet" seçeneğini seçin</li>
                    <li>Bilgisayarınızda bir konum seçin ve kaydedin</li>
                </ol>
                <p class="text-sm text-gray-500">Not: Mobil cihazlarda görsele uzun basarak kaydedebilirsiniz.</p>
                <button id="try-direct-download" class="mt-4 btn-secondary py-2 px-6 rounded">Doğrudan İndirmeyi Dene</button>
            </div>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8">
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-bold" style="color: var(--primary);">Reklamingo Görsel Oluşturucu</h1>
            <button id="show-code-modal" class="btn-primary py-2 px-4 rounded hidden">Kod Gir</button>
        </div>
        
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Kontrol Paneli -->
            <div class="w-full lg:w-1/3 bg-white rounded-lg shadow-md p-6">
                <!-- Tabs -->
                <div class="flex border-b mb-6 overflow-x-auto">
                    <button class="tab-btn px-4 py-2 tab-active whitespace-nowrap" data-tab="boyut">Boyut</button>
                    <button class="tab-btn px-4 py-2 whitespace-nowrap" data-tab="arkaplan">Arkaplan</button>
                    <button class="tab-btn px-4 py-2 whitespace-nowrap" data-tab="metin">Metin</button>
                    <button class="tab-btn px-4 py-2 whitespace-nowrap" data-tab="logo">Logo</button>
                    <button class="tab-btn px-4 py-2 whitespace-nowrap" data-tab="cerceve">Çerçeve</button>
                </div>
                
                <!-- Boyut Tab -->
                <div id="boyut-tab" class="tab-content">
                    <h2 class="text-lg font-semibold mb-4">Boyut Seçin</h2>
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <button class="boyut-btn p-3 border rounded-lg hover:bg-gray-100 flex flex-col items-center" data-width="500" data-height="500">
                            <div class="w-16 h-16 border-2 border-gray-300 mb-2"></div>
                            <span>Kare (1:1)</span>
                        </button>
                        <button class="boyut-btn p-3 border rounded-lg hover:bg-gray-100 flex flex-col items-center" data-width="600" data-height="450">
                            <div class="w-16 h-12 border-2 border-gray-300 mb-2"></div>
                            <span>4:3</span>
                        </button>
                        <button class="boyut-btn p-3 border rounded-lg hover:bg-gray-100 flex flex-col items-center" data-width="450" data-height="800">
                            <div class="w-9 h-16 border-2 border-gray-300 mb-2"></div>
                            <span>9:16</span>
                        </button>
                        <button class="boyut-btn p-3 border rounded-lg hover:bg-gray-100 flex flex-col items-center" data-custom="true">
                            <div class="w-16 h-12 border-2 border-dashed border-gray-300 mb-2 flex items-center justify-center">
                                <span class="text-xs">Özel</span>
                            </div>
                            <span>Serbest Boyut</span>
                        </button>
                    </div>
                    
                    <div id="custom-size" class="hidden mb-6">
                        <div class="flex gap-4">
                            <div class="w-1/2">
                                <label class="block text-sm font-medium mb-1">Genişlik (px)</label>
                                <input type="number" id="custom-width" class="w-full p-2 border rounded" value="800">
                            </div>
                            <div class="w-1/2">
                                <label class="block text-sm font-medium mb-1">Yükseklik (px)</label>
                                <input type="number" id="custom-height" class="w-full p-2 border rounded" value="600">
                            </div>
                        </div>
                        <button id="apply-custom-size" class="mt-3 w-full btn-primary py-2 px-4 rounded">Uygula</button>
                    </div>
                </div>
                
                <!-- Arkaplan Tab -->
                <div id="arkaplan-tab" class="tab-content hidden">
                    <h2 class="text-lg font-semibold mb-4">Arkaplan</h2>
                    
                    <div class="mb-4">
                        <div class="flex items-center mb-3">
                            <input type="radio" id="bg-color" name="bg-type" value="color" checked class="mr-2">
                            <label for="bg-color">Renk</label>
                            
                            <input type="radio" id="bg-gradient" name="bg-type" value="gradient" class="ml-6 mr-2">
                            <label for="bg-gradient">Gradyan</label>
                            
                            <input type="radio" id="bg-image" name="bg-type" value="image" class="ml-6 mr-2">
                            <label for="bg-image">Fotoğraf</label>
                        </div>
                    </div>
                    
                    <div id="color-section">
                        <h3 class="text-md font-medium mb-2">Düz Renkler</h3>
                        <div class="flex flex-wrap gap-2 mb-4">
                            <div class="color-option" style="background-color: #ffffff; border: 1px solid #e2e8f0;" data-color="#ffffff"></div>
                            <div class="color-option" style="background-color: #f8f9fa;" data-color="#f8f9fa"></div>
                            <div class="color-option" style="background-color: #e9ecef;" data-color="#e9ecef"></div>
                            <div class="color-option" style="background-color: #dee2e6;" data-color="#dee2e6"></div>
                            <div class="color-option" style="background-color: #003e92;" data-color="#003e92"></div>
                            <div class="color-option" style="background-color: #3ecf00;" data-color="#3ecf00"></div>
                            <div class="color-option" style="background-color: #fd7e14;" data-color="#fd7e14"></div>
                            <div class="color-option" style="background-color: #dc3545;" data-color="#dc3545"></div>
                            <div class="color-option" style="background-color: #6f42c1;" data-color="#6f42c1"></div>
                            <div class="color-option" style="background-color: #20c997;" data-color="#20c997"></div>
                            <div class="color-option" style="background-color: #0dcaf0;" data-color="#0dcaf0"></div>
                            <div class="color-option" style="background-color: #212529;" data-color="#212529"></div>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium mb-1">Özel Renk</label>
                            <input type="color" id="custom-color" class="w-full h-10 p-1 border rounded" value="#ffffff">
                            <button id="apply-custom-color" class="mt-2 w-full btn-primary py-2 px-4 rounded">Rengi Uygula</button>
                        </div>
                    </div>
                    
                    <div id="gradient-section" class="hidden">
                        <h3 class="text-md font-medium mb-2">Gradyan Renkler</h3>
                        <div class="flex flex-wrap gap-2 mb-4">
                            <div class="gradient-option" style="background: linear-gradient(135deg, #003e92, #3ecf00);" data-gradient="linear-gradient(135deg, #003e92, #3ecf00)"></div>
                            <div class="gradient-option" style="background: linear-gradient(135deg, #667eea, #764ba2);" data-gradient="linear-gradient(135deg, #667eea, #764ba2)"></div>
                            <div class="gradient-option" style="background: linear-gradient(135deg, #2af598, #009efd);" data-gradient="linear-gradient(135deg, #2af598, #009efd)"></div>
                            <div class="gradient-option" style="background: linear-gradient(135deg, #f6d365, #fda085);" data-gradient="linear-gradient(135deg, #f6d365, #fda085)"></div>
                            <div class="gradient-option" style="background: linear-gradient(135deg, #ff9a9e, #fad0c4);" data-gradient="linear-gradient(135deg, #ff9a9e, #fad0c4)"></div>
                            <div class="gradient-option" style="background: linear-gradient(135deg, #a18cd1, #fbc2eb);" data-gradient="linear-gradient(135deg, #a18cd1, #fbc2eb)"></div>
                        </div>
                        
                        <div class="mb-4">
                            <h3 class="text-md font-medium mb-2">Özel Gradyan</h3>
                            <div class="flex gap-4 mb-2">
                                <div class="w-1/2">
                                    <label class="block text-sm font-medium mb-1">Renk 1</label>
                                    <input type="color" id="gradient-color-1" class="w-full h-10 p-1 border rounded" value="#003e92">
                                </div>
                                <div class="w-1/2">
                                    <label class="block text-sm font-medium mb-1">Renk 2</label>
                                    <input type="color" id="gradient-color-2" class="w-full h-10 p-1 border rounded" value="#3ecf00">
                                </div>
                            </div>
                            <label class="block text-sm font-medium mb-1">Açı: <span id="angle-value">135</span>°</label>
                            <input type="range" id="gradient-angle" min="0" max="360" value="135" class="w-full mb-2">
                            <button id="apply-custom-gradient" class="mt-2 w-full btn-primary py-2 px-4 rounded">Gradyanı Uygula</button>
                        </div>
                    </div>
                    
                    <div id="image-section" class="hidden">
                        <h3 class="text-md font-medium mb-2">Fotoğraf Yükle</h3>
                        <input type="file" id="bg-image-upload" class="w-full p-2 border rounded" accept="image/*">
                        <p class="text-xs text-gray-500 mt-1">PNG veya JPEG formatında fotoğraf yükleyin.</p>
                    </div>
                </div>
                
                <!-- Metin Tab -->
                <div id="metin-tab" class="tab-content hidden">
                    <h2 class="text-lg font-semibold mb-4">Metin Ayarları</h2>
                    
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-1">Başlık</label>
                        <input type="text" id="title-text" class="w-full p-2 border rounded" placeholder="Başlık ekleyin" value="Harika Başlık">
                        
                        <div class="mt-3">
                            <label class="block text-sm font-medium mb-1">Yazı Tipi</label>
<select id="title-font" class="w-full p-2 border rounded">
  <option value="'Quicksand', sans-serif">Quicksand</option>
  <option value="Arial, sans-serif">Arial</option>
  <option value="'Times New Roman', serif">Times New Roman</option>
  <option value="'Courier New', monospace">Courier New</option>
  <option value="Georgia, serif">Georgia</option>
  <option value="'Trebuchet MS', sans-serif">Trebuchet MS</option>
  <option value="'Roboto', sans-serif">Roboto</option>
  <option value="'Open Sans', sans-serif">Open Sans</option>
  <option value="'Lato', sans-serif">Lato</option>
  <option value="'Montserrat', sans-serif">Montserrat</option>
  <option value="'Playfair Display', serif">Playfair Display</option>
  <option value="'Merriweather', serif">Merriweather</option>
  <option value="'Raleway', sans-serif">Raleway</option>
  <option value="'Ubuntu', sans-serif">Ubuntu</option>
  <option value="'Nunito', sans-serif">Nunito</option>
  <option value="'Poppins', sans-serif">Poppins</option>
  <option value="'Oswald', sans-serif">Oswald</option>
  <option value="'PT Serif', serif">PT Serif</option>
  <option value="'Source Sans Pro', sans-serif">Source Sans Pro</option>
  <option value="'Fira Sans', sans-serif">Fira Sans</option>
                            </select>
                        </div>
                        
                        <div class="mt-3">
                            <label class="block text-sm font-medium mb-1">Boyut: <span id="title-size-value">36</span>px</label>
                            <input type="range" id="title-size" min="12" max="72" value="36" class="w-full">
                        </div>
                        
                        <div class="mt-3">
                            <label class="block text-sm font-medium mb-1">Renk</label>
                            <input type="color" id="title-color" class="w-full h-10 p-1 border rounded" value="#212529">
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-1">Alt Metin</label>
                        <textarea id="subtitle-text" class="w-full p-2 border rounded" rows="2" placeholder="Alt metin ekleyin">Burada ürün veya hizmetiniz hakkında kısa bir açıklama yer alabilir.</textarea>
                        
                        <div class="mt-3">
                            <label class="block text-sm font-medium mb-1">Yazı Tipi</label>
<select id="title-font" class="w-full p-2 border rounded">
  <option value="'Quicksand', sans-serif">Quicksand</option>
  <option value="Arial, sans-serif">Arial</option>
  <option value="'Times New Roman', serif">Times New Roman</option>
  <option value="'Courier New', monospace">Courier New</option>
  <option value="Georgia, serif">Georgia</option>
  <option value="'Trebuchet MS', sans-serif">Trebuchet MS</option>
  <option value="'Roboto', sans-serif">Roboto</option>
  <option value="'Open Sans', sans-serif">Open Sans</option>
  <option value="'Lato', sans-serif">Lato</option>
  <option value="'Montserrat', sans-serif">Montserrat</option>
  <option value="'Playfair Display', serif">Playfair Display</option>
  <option value="'Merriweather', serif">Merriweather</option>
  <option value="'Raleway', sans-serif">Raleway</option>
  <option value="'Ubuntu', sans-serif">Ubuntu</option>
  <option value="'Nunito', sans-serif">Nunito</option>
  <option value="'Poppins', sans-serif">Poppins</option>
  <option value="'Oswald', sans-serif">Oswald</option>
  <option value="'PT Serif', serif">PT Serif</option>
  <option value="'Source Sans Pro', sans-serif">Source Sans Pro</option>
  <option value="'Fira Sans', sans-serif">Fira Sans</option>
                            </select>
                        </div>
                        
                        <div class="mt-3">
                            <label class="block text-sm font-medium mb-1">Boyut: <span id="subtitle-size-value">18</span>px</label>
                            <input type="range" id="subtitle-size" min="10" max="36" value="18" class="w-full">
                        </div>
                        
                        <div class="mt-3">
                            <label class="block text-sm font-medium mb-1">Renk</label>
                            <input type="color" id="subtitle-color" class="w-full h-10 p-1 border rounded" value="#495057">
                        </div>
                    </div>
                    <div class="mt-3 flex gap-4">
  <label class="flex items-center">
    <input type="checkbox" id="title-bold" class="mr-2"> <span>Kalın</span>
  </label>
  <label class="flex items-center">
    <input type="checkbox" id="title-italic" class="mr-2"> <span>İtalik</span>
  </label>
</div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-1">Metinler Arası Mesafe: <span id="text-spacing-value">20</span>px</label>
                        <input type="range" id="text-spacing" min="0" max="100" value="20" class="w-full">
                    </div>
                </div>
                
                <!-- Logo Tab -->
                <div id="logo-tab" class="tab-content hidden">
                    <h2 class="text-lg font-semibold mb-4">Logo / İsim</h2>
                    
                    <div class="mb-6">
                        <div class="flex items-center mb-4">
                            <input type="radio" id="use-logo" name="logo-type" value="logo" checked class="mr-2">
                            <label for="use-logo">Logo Yükle</label>
                            
                            <input type="radio" id="use-text" name="logo-type" value="text" class="ml-6 mr-2">
                            <label for="use-text">İsim Kullan</label>
                        </div>
                        
                        <div id="logo-upload-section">
                            <label class="block text-sm font-medium mb-1">Logo Seçin</label>
                            <input type="file" id="logo-upload" class="w-full p-2 border rounded" accept="image/*">
                            <p class="text-xs text-gray-500 mt-1">PNG veya JPEG formatında logo yükleyin.</p>
                            
                            <div class="mt-4">
                                <h3 class="text-md font-medium mb-2">Logo Hizalama</h3>
                                <div class="logo-alignment mb-3">
                                    <button class="align-btn" data-align="top-left">↖️</button>
                                    <button class="align-btn" data-align="top-center">⬆️</button>
                                    <button class="align-btn" data-align="top-right">↗️</button>
                                    <button class="align-btn" data-align="middle-left">⬅️</button>
                                    <button class="align-btn" data-align="middle-center">⚪</button>
                                    <button class="align-btn" data-align="middle-right">➡️</button>
                                    <button class="align-btn" data-align="bottom-left">↙️</button>
                                    <button class="align-btn" data-align="bottom-center">⬇️</button>
                                    <button class="align-btn" data-align="bottom-right">↘️</button>
                                </div>
                                <p class="text-xs text-gray-500">Logoyu sürükleyerek istediğiniz konuma yerleştirebilirsiniz.</p>
                            </div>
                            
                            <div class="mt-4">
                                <h3 class="text-md font-medium mb-2">Logo Boyutu</h3>
                                <label class="block text-sm font-medium mb-1">Boyut: <span id="logo-size-value">100</span>%</label>
                                <input type="range" id="logo-size" min="10" max="200" value="100" class="w-full">
                            </div>
                        </div>
                        
                        <div id="logo-text-section" class="hidden">
                            <label class="block text-sm font-medium mb-1">İsim</label>
                            <input type="text" id="logo-text" class="w-full p-2 border rounded" placeholder="Firma/Marka İsmi" value="Marka İsmi">
                            
                            <div class="mt-3">
                                <label class="block text-sm font-medium mb-1">Yazı Tipi</label>
                                <select id="logo-text-font" class="w-full p-2 border rounded">
                                    <option value="'Quicksand', sans-serif" selected>Quicksand</option>
                                    <option value="Arial, sans-serif">Arial</option>
                                    <option value="'Times New Roman', serif">Times New Roman</option>
                                    <option value="'Courier New', monospace">Courier New</option>
                                    <option value="Georgia, serif">Georgia</option>
                                    <option value="'Trebuchet MS', sans-serif">Trebuchet MS</option>
                                </select>
                            </div>
                            
                            <div class="mt-3">
                                <label class="block text-sm font-medium mb-1">Boyut: <span id="logo-text-size-value">24</span>px</label>
                                <input type="range" id="logo-text-size" min="10" max="48" value="24" class="w-full">
                            </div>
                            
                            <div class="mt-3">
                                <label class="block text-sm font-medium mb-1">Renk</label>
                                <input type="color" id="logo-text-color" class="w-full h-10 p-1 border rounded" value="#003e92">
                            </div>
                            
                            <div class="mt-4">
                                <h3 class="text-md font-medium mb-2">İsim Hizalama</h3>
                                <div class="logo-alignment mb-3">
                                    <button class="align-btn" data-align="top-left">↖️</button>
                                    <button class="align-btn" data-align="top-center">⬆️</button>
                                    <button class="align-btn" data-align="top-right">↗️</button>
                                    <button class="align-btn" data-align="middle-left">⬅️</button>
                                    <button class="align-btn" data-align="middle-center">⚪</button>
                                    <button class="align-btn" data-align="middle-right">➡️</button>
                                    <button class="align-btn" data-align="bottom-left">↙️</button>
                                    <button class="align-btn" data-align="bottom-center">⬇️</button>
                                    <button class="align-btn" data-align="bottom-right">↘️</button>
                                </div>
                                <p class="text-xs text-gray-500">Metni sürükleyerek istediğiniz konuma yerleştirebilirsiniz.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Çerçeve Tab -->
                <div id="cerceve-tab" class="tab-content hidden">
                    <h2 class="text-lg font-semibold mb-4">Çerçeve Ayarları</h2>
                    
                    <div class="mb-4">
                        <div class="flex items-center mb-4">
                            <input type="checkbox" id="enable-frame" class="mr-2">
                            <label for="enable-frame">Çerçeve Ekle</label>
                        </div>
                        
                        <div id="frame-settings" class="hidden">
                            <div class="mb-3">
                                <label class="block text-sm font-medium mb-1">Kalınlık: <span id="frame-thickness-value">2</span>px</label>
                                <input type="range" id="frame-thickness" min="1" max="20" value="2" class="w-full">
                            </div>
                            
                            <div class="mb-3">
                                <label class="block text-sm font-medium mb-1">Kenarlardan Uzaklık: <span id="frame-distance-value">20</span>px</label>
                                <input type="range" id="frame-distance" min="0" max="100" value="20" class="w-full">
                            </div>
                            
                            <div class="mb-3">
                                <label class="block text-sm font-medium mb-1">Renk</label>
                                <input type="color" id="frame-color" class="w-full h-10 p-1 border rounded" value="#003e92">
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8">
                    <button id="download-btn" class="w-full btn-secondary py-3 px-4 rounded font-bold text-lg">Görseli Oluştur</button>
                    <div id="download-progress" class="text-center">
                        <p>Görsel hazırlanıyor...</p>
                        <div class="progress-bar">
                            <div class="progress-bar-fill"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Önizleme -->
            <div class="w-full lg:w-2/3">
                <div class="bg-gray-100 p-6 rounded-lg shadow-inner flex items-center justify-center min-h-[500px]">
                    <div id="canvas-container" class="canvas-container" style="width: 500px; height: 500px;">
                        <div id="canvas-content" class="w-full h-full flex flex-col items-center justify-center p-8 text-center">
                            <h2 id="title-preview" style="font-size: 36px; color: #212529; font-family: 'Quicksand', sans-serif;">Harika Başlık</h2>
                            <div id="text-spacer" style="height: 20px;"></div>
                            <p id="subtitle-preview" style="font-size: 18px; color: #495057; font-family: 'Quicksand', sans-serif;">Burada ürün veya hizmetiniz hakkında kısa bir açıklama yer alabilir.</p>
                        </div>
                        <div id="canvas-frame" class="canvas-frame hidden"></div>
                        <div id="logo-container" class="logo-container hidden">
                            <img id="logo-image" class="hidden" src="" alt="Logo">
                            <div id="logo-text-preview" class="hidden" style="font-family: 'Quicksand', sans-serif; font-size: 24px; color: #003e92;">Marka İsmi</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="usage-limit" class="usage-limit">
        İlk kullanım ücretsiz! Sonraki kullanımlar için reklamingo.com.tr'den kod alabilirsiniz.
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Test kodları
            const validCodes = ['REKL2023', 'MINGO49', 'PROMO123', 'TEST456', 'DESIGN789'];
            
            // Kullanım sınırı kontrolü
            let usedFree = localStorage.getItem('usedFreeDesign') === 'true';
            let hasValidCode = localStorage.getItem('hasValidCode') === 'true';
            
            function checkUsageLimit() {
                const usageLimitDiv = document.getElementById('usage-limit');
                const showCodeModalBtn = document.getElementById('show-code-modal');
                
                if (usedFree && !hasValidCode) {
                    usageLimitDiv.textContent = 'Ücretsiz kullanım hakkınız doldu. Devam etmek için reklamingo.com.tr\'den kod alabilirsiniz.';
                    usageLimitDiv.style.backgroundColor = 'rgba(220, 53, 69, 0.9)';
                    showCodeModalBtn.classList.remove('hidden');
                } else if (hasValidCode) {
                    usageLimitDiv.textContent = 'Aktivasyon kodunuz başarıyla doğrulandı. Görsel oluşturucuyu kullanabilirsiniz.';
                    usageLimitDiv.style.backgroundColor = 'rgba(62, 207, 0, 0.9)';
                    setTimeout(() => {
                        usageLimitDiv.style.display = 'none';
                    }, 5000);
                }
            }
            
            // Kod modalı
            const codeModal = document.getElementById('code-modal');
            const closeCodeModal = document.getElementById('close-code-modal');
            const showCodeModal = document.getElementById('show-code-modal');
            const verifyCodeBtn = document.getElementById('verify-code');
            const cancelCodeBtn = document.getElementById('cancel-code');
            const activationCodeInput = document.getElementById('activation-code');
            const codeMessage = document.getElementById('code-message');
            
            // Önizleme modalı
            const previewModal = document.getElementById('preview-modal');
            const closePreviewModal = document.getElementById('close-preview-modal');
            const previewImage = document.getElementById('preview-image');
            const tryDirectDownloadBtn = document.getElementById('try-direct-download');
            
            showCodeModal.addEventListener('click', () => {
                codeModal.style.display = 'block';
            });
            
            closeCodeModal.addEventListener('click', () => {
                codeModal.style.display = 'none';
            });
            
            cancelCodeBtn.addEventListener('click', () => {
                codeModal.style.display = 'none';
            });
            
            closePreviewModal.addEventListener('click', () => {
                previewModal.style.display = 'none';
            });
            
            verifyCodeBtn.addEventListener('click', () => {
                const code = activationCodeInput.value.trim();
                
                if (validCodes.includes(code)) {
                    codeMessage.textContent = 'Kod başarıyla doğrulandı!';
                    codeMessage.classList.remove('hidden', 'text-red-500');
                    codeMessage.classList.add('text-green-500');
                    
                    localStorage.setItem('hasValidCode', 'true');
                    hasValidCode = true;
                    
                    setTimeout(() => {
                        codeModal.style.display = 'none';
                        checkUsageLimit();
                    }, 1500);
                } else {
                    codeMessage.textContent = 'Geçersiz kod. Lütfen tekrar deneyin.';
                    codeMessage.classList.remove('hidden', 'text-green-500');
                    codeMessage.classList.add('text-red-500');
                }
            });
            
            // Tab değiştirme
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    tabBtns.forEach(b => b.classList.remove('tab-active'));
                    btn.classList.add('tab-active');
                    
                    const tabId = btn.getAttribute('data-tab');
                    tabContents.forEach(content => {
                        content.classList.add('hidden');
                    });
                    document.getElementById(`${tabId}-tab`).classList.remove('hidden');
                });
            });
            
            // Boyut ayarları
            const canvasContainer = document.getElementById('canvas-container');
            const boyutBtns = document.querySelectorAll('.boyut-btn');
            const customSizeDiv = document.getElementById('custom-size');
            const customWidthInput = document.getElementById('custom-width');
            const customHeightInput = document.getElementById('custom-height');
            const applyCustomSizeBtn = document.getElementById('apply-custom-size');
            
            boyutBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    boyutBtns.forEach(b => b.classList.remove('bg-gray-200'));
                    btn.classList.add('bg-gray-200');
                    
                    if (btn.getAttribute('data-custom') === 'true') {
                        customSizeDiv.classList.remove('hidden');
                    } else {
                        customSizeDiv.classList.add('hidden');
                        const width = btn.getAttribute('data-width');
                        const height = btn.getAttribute('data-height');
                        canvasContainer.style.width = `${width}px`;
                        canvasContainer.style.height = `${height}px`;
                        updateLogoPosition();
                    }
                });
            });
            
            applyCustomSizeBtn.addEventListener('click', () => {
                const width = customWidthInput.value;
                const height = customHeightInput.value;
                canvasContainer.style.width = `${width}px`;
                canvasContainer.style.height = `${height}px`;
                updateLogoPosition();
            });
            
            // Arkaplan ayarları
            const canvasContent = document.getElementById('canvas-content');
            const bgColorRadio = document.getElementById('bg-color');
            const bgGradientRadio = document.getElementById('bg-gradient');
            const bgImageRadio = document.getElementById('bg-image');
            const colorSection = document.getElementById('color-section');
            const gradientSection = document.getElementById('gradient-section');
            const imageSection = document.getElementById('image-section');
            
            bgColorRadio.addEventListener('change', () => {
                if (bgColorRadio.checked) {
                    colorSection.classList.remove('hidden');
                    gradientSection.classList.add('hidden');
                    imageSection.classList.add('hidden');
                }
            });
            
            bgGradientRadio.addEventListener('change', () => {
                if (bgGradientRadio.checked) {
                    colorSection.classList.add('hidden');
                    gradientSection.classList.remove('hidden');
                    imageSection.classList.add('hidden');
                }
            });
            
            bgImageRadio.addEventListener('change', () => {
                if (bgImageRadio.checked) {
                    colorSection.classList.add('hidden');
                    gradientSection.classList.add('hidden');
                    imageSection.classList.remove('hidden');
                }
            });
            
            const colorOptions = document.querySelectorAll('.color-option');
            const gradientOptions = document.querySelectorAll('.gradient-option');
            const customColorInput = document.getElementById('custom-color');
            const applyCustomColorBtn = document.getElementById('apply-custom-color');
            const gradientColor1 = document.getElementById('gradient-color-1');
            const gradientColor2 = document.getElementById('gradient-color-2');
            const gradientAngle = document.getElementById('gradient-angle');
            const angleValue = document.getElementById('angle-value');
            const applyCustomGradientBtn = document.getElementById('apply-custom-gradient');
            const bgImageUpload = document.getElementById('bg-image-upload');
            
            colorOptions.forEach(option => {
                option.addEventListener('click', () => {
                    const color = option.getAttribute('data-color');
                    canvasContent.style.background = color;
                });
            });
            
            gradientOptions.forEach(option => {
                option.addEventListener('click', () => {
                    const gradient = option.getAttribute('data-gradient');
                    canvasContent.style.background = gradient;
                });
            });
            
            applyCustomColorBtn.addEventListener('click', () => {
                const color = customColorInput.value;
                canvasContent.style.background = color;
            });
            
            gradientAngle.addEventListener('input', () => {
                angleValue.textContent = gradientAngle.value;
            });
            
            applyCustomGradientBtn.addEventListener('click', () => {
                const color1 = gradientColor1.value;
                const color2 = gradientColor2.value;
                const angle = gradientAngle.value;
                const gradient = `linear-gradient(${angle}deg, ${color1}, ${color2})`;
                canvasContent.style.background = gradient;
            });
            
            bgImageUpload.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        canvasContent.style.background = `url(${event.target.result}) center/cover no-repeat`;
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Metin ayarları
            const titleText = document.getElementById('title-text');
            const titleFont = document.getElementById('title-font');
            const titleSize = document.getElementById('title-size');
            const titleSizeValue = document.getElementById('title-size-value');
            const titleColor = document.getElementById('title-color');
            const titlePreview = document.getElementById('title-preview');
            
            const subtitleText = document.getElementById('subtitle-text');
            const subtitleFont = document.getElementById('subtitle-font');
            const subtitleSize = document.getElementById('subtitle-size');
            const subtitleSizeValue = document.getElementById('subtitle-size-value');
            const subtitleColor = document.getElementById('subtitle-color');
            const subtitlePreview = document.getElementById('subtitle-preview');
            
            const textSpacing = document.getElementById('text-spacing');
            const textSpacingValue = document.getElementById('text-spacing-value');
            const textSpacer = document.getElementById('text-spacer');
            
            titleText.addEventListener('input', () => {
                titlePreview.textContent = titleText.value;
            });
            
            titleFont.addEventListener('change', () => {
                titlePreview.style.fontFamily = titleFont.value;
            });
            
            titleSize.addEventListener('input', () => {
                titleSizeValue.textContent = titleSize.value;
                titlePreview.style.fontSize = `${titleSize.value}px`;
            });
            
            titleColor.addEventListener('input', () => {
                titlePreview.style.color = titleColor.value;
            });
            
            subtitleText.addEventListener('input', () => {
                subtitlePreview.textContent = subtitleText.value;
            });
            
            subtitleFont.addEventListener('change', () => {
                subtitlePreview.style.fontFamily = subtitleFont.value;
            });
            
            subtitleSize.addEventListener('input', () => {
                subtitleSizeValue.textContent = subtitleSize.value;
                subtitlePreview.style.fontSize = `${subtitleSize.value}px`;
            });
            
            subtitleColor.addEventListener('input', () => {
                subtitlePreview.style.color = subtitleColor.value;
            });
            
            textSpacing.addEventListener('input', () => {
                textSpacingValue.textContent = textSpacing.value;
                textSpacer.style.height = `${textSpacing.value}px`;
            });
            
            // Logo ayarları
            const useLogoRadio = document.getElementById('use-logo');
            const useTextRadio = document.getElementById('use-text');
            const logoUploadSection = document.getElementById('logo-upload-section');
            const logoTextSection = document.getElementById('logo-text-section');
            const logoUpload = document.getElementById('logo-upload');
            const logoImage = document.getElementById('logo-image');
            const logoContainer = document.getElementById('logo-container');
            const logoTextInput = document.getElementById('logo-text');
            const logoTextFont = document.getElementById('logo-text-font');
            const logoTextSize = document.getElementById('logo-text-size');
            const logoTextSizeValue = document.getElementById('logo-text-size-value');
            const logoTextColor = document.getElementById('logo-text-color');
            const logoTextPreview = document.getElementById('logo-text-preview');
            const alignBtns = document.querySelectorAll('.align-btn');
            const logoSize = document.getElementById('logo-size');
            const logoSizeValue = document.getElementById('logo-size-value');
            
            useLogoRadio.addEventListener('change', () => {
                if (useLogoRadio.checked) {
                    logoUploadSection.classList.remove('hidden');
                    logoTextSection.classList.add('hidden');
                    logoImage.classList.remove('hidden');
                    logoTextPreview.classList.add('hidden');
                }
            });
            
            useTextRadio.addEventListener('change', () => {
                if (useTextRadio.checked) {
                    logoUploadSection.classList.add('hidden');
                    logoTextSection.classList.remove('hidden');
                    logoImage.classList.add('hidden');
                    logoTextPreview.classList.remove('hidden');
                }
            });
            
            logoUpload.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        logoImage.src = event.target.result;
                        logoImage.classList.remove('hidden');
                        logoContainer.classList.remove('hidden');
                        
                        // Logo boyutunu ayarla
                        logoImage.onload = function() {
                            const maxWidth = 150;
                            const maxHeight = 150;
                            const ratio = Math.min(maxWidth / logoImage.naturalWidth, maxHeight / logoImage.naturalHeight);
                            
                            logoContainer.style.width = `${logoImage.naturalWidth * ratio}px`;
                            logoContainer.style.height = `${logoImage.naturalHeight * ratio}px`;
                            
                            // Ortalama
                            centerLogo();
                        };
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            logoSize.addEventListener('input', () => {
                logoSizeValue.textContent = logoSize.value;
                
                if (logoImage.naturalWidth) {
                    const maxWidth = 150;
                    const maxHeight = 150;
                    const baseRatio = Math.min(maxWidth / logoImage.naturalWidth, maxHeight / logoImage.naturalHeight);
                    const sizeRatio = logoSize.value / 100;
                    
                    logoContainer.style.width = `${logoImage.naturalWidth * baseRatio * sizeRatio}px`;
                    logoContainer.style.height = `${logoImage.naturalHeight * baseRatio * sizeRatio}px`;
                }
            });
            
            logoTextInput.addEventListener('input', () => {
                logoTextPreview.textContent = logoTextInput.value;
                logoContainer.classList.remove('hidden');
            });
            
            logoTextFont.addEventListener('change', () => {
                logoTextPreview.style.fontFamily = logoTextFont.value;
            });
            
            logoTextSize.addEventListener('input', () => {
                logoTextSizeValue.textContent = logoTextSize.value;
                logoTextPreview.style.fontSize = `${logoTextSize.value}px`;
            });
            
            logoTextColor.addEventListener('input', () => {
                logoTextPreview.style.color = logoTextColor.value;
            });
            
            // Logo hizalama
            alignBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    alignBtns.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    const alignment = btn.getAttribute('data-align');
                    alignLogo(alignment);
                });
            });
            
            function alignLogo(position) {
                const containerWidth = canvasContainer.offsetWidth;
                const containerHeight = canvasContainer.offsetHeight;
                const logoWidth = logoContainer.offsetWidth;
                const logoHeight = logoContainer.offsetHeight;
                
                const padding = 20;
                
                switch(position) {
                    case 'top-left':
                        logoContainer.style.left = `${padding}px`;
                        logoContainer.style.top = `${padding}px`;
                        break;
                    case 'top-center':
                        logoContainer.style.left = `${(containerWidth - logoWidth) / 2}px`;
                        logoContainer.style.top = `${padding}px`;
                        break;
                    case 'top-right':
                        logoContainer.style.left = `${containerWidth - logoWidth - padding}px`;
                        logoContainer.style.top = `${padding}px`;
                        break;
                    case 'middle-left':
                        logoContainer.style.left = `${padding}px`;
                        logoContainer.style.top = `${(containerHeight - logoHeight) / 2}px`;
                        break;
                    case 'middle-center':
                        logoContainer.style.left = `${(containerWidth - logoWidth) / 2}px`;
                        logoContainer.style.top = `${(containerHeight - logoHeight) / 2}px`;
                        break;
                    case 'middle-right':
                        logoContainer.style.left = `${containerWidth - logoWidth - padding}px`;
                        logoContainer.style.top = `${(containerHeight - logoHeight) / 2}px`;
                        break;
                    case 'bottom-left':
                        logoContainer.style.left = `${padding}px`;
                        logoContainer.style.top = `${containerHeight - logoHeight - padding}px`;
                        break;
                    case 'bottom-center':
                        logoContainer.style.left = `${(containerWidth - logoWidth) / 2}px`;
                        logoContainer.style.top = `${containerHeight - logoHeight - padding}px`;
                        break;
                    case 'bottom-right':
                        logoContainer.style.left = `${containerWidth - logoWidth - padding}px`;
                        logoContainer.style.top = `${containerHeight - logoHeight - padding}px`;
                        break;
                }
            }
            
            function centerLogo() {
                logoContainer.style.left = `${(canvasContainer.offsetWidth - logoContainer.offsetWidth) / 2}px`;
                logoContainer.style.top = `${(canvasContainer.offsetHeight - logoContainer.offsetHeight) / 2}px`;
            }
            
            function updateLogoPosition() {
                if (!logoContainer.classList.contains('hidden')) {
                    const activeAlignBtn = document.querySelector('.align-btn.active');
                    if (activeAlignBtn) {
                        alignLogo(activeAlignBtn.getAttribute('data-align'));
                    } else {
                        centerLogo();
                    }
                }
            }
            
            // Logo sürükleme
            let isDragging = false;
            let startX, startY, startLeft, startTop;
            
            logoContainer.addEventListener('mousedown', (e) => {
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                startLeft = parseInt(window.getComputedStyle(logoContainer).left) || 0;
                startTop = parseInt(window.getComputedStyle(logoContainer).top) || 0;
                e.preventDefault();
            });
            
            document.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    const deltaX = e.clientX - startX;
                    const deltaY = e.clientY - startY;
                    
                    const newLeft = startLeft + deltaX;
                    const newTop = startTop + deltaY;
                    
                    const containerRect = canvasContainer.getBoundingClientRect();
                    const logoRect = logoContainer.getBoundingClientRect();
                    
                    const maxLeft = containerRect.width - logoRect.width;
                    const maxTop = containerRect.height - logoRect.height;
                    
                    logoContainer.style.left = `${Math.max(0, Math.min(newLeft, maxLeft))}px`;
                    logoContainer.style.top = `${Math.max(0, Math.min(newTop, maxTop))}px`;
                    
                    // Hizalama butonlarını temizle
                    alignBtns.forEach(btn => btn.classList.remove('active'));
                }
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
            });
            
            // Çerçeve ayarları
            const enableFrame = document.getElementById('enable-frame');
            const frameSettings = document.getElementById('frame-settings');
            const frameThickness = document.getElementById('frame-thickness');
            const frameThicknessValue = document.getElementById('frame-thickness-value');
            const frameDistance = document.getElementById('frame-distance');
            const frameDistanceValue = document.getElementById('frame-distance-value');
            const frameColor = document.getElementById('frame-color');
            const canvasFrame = document.getElementById('canvas-frame');
            
            enableFrame.addEventListener('change', () => {
                if (enableFrame.checked) {
                    frameSettings.classList.remove('hidden');
                    canvasFrame.classList.remove('hidden');
                    updateFrame();
                } else {
                    frameSettings.classList.add('hidden');
                    canvasFrame.classList.add('hidden');
                }
            });
            
            frameThickness.addEventListener('input', () => {
                frameThicknessValue.textContent = frameThickness.value;
                updateFrame();
            });
            
            frameDistance.addEventListener('input', () => {
                frameDistanceValue.textContent = frameDistance.value;
                updateFrame();
            });
            
            frameColor.addEventListener('input', () => {
                updateFrame();
            });
            
            function updateFrame() {
                const thickness = frameThickness.value;
                const distance = frameDistance.value;
                const color = frameColor.value;
                
                canvasFrame.style.border = `${thickness}px solid ${color}`;
                canvasFrame.style.top = `${distance}px`;
                canvasFrame.style.left = `${distance}px`;
                canvasFrame.style.right = `${distance}px`;
                canvasFrame.style.bottom = `${distance}px`;
            }
            
            // Görsel oluşturma ve indirme
            const downloadBtn = document.getElementById('download-btn');
            const downloadProgress = document.getElementById('download-progress');
            const progressBarFill = document.querySelector('.progress-bar-fill');
            
            downloadBtn.addEventListener('click', () => {
                if (usedFree && !hasValidCode) {
                    showCodeModal.click();
                    return;
                }
                
                // İndirme işlemi başladığında düğmeyi devre dışı bırak ve ilerleme çubuğunu göster
                downloadBtn.disabled = true;
                downloadBtn.textContent = 'Hazırlanıyor...';
                downloadProgress.style.display = 'block';
                progressBarFill.style.width = '10%';
                
                // Çerçeveyi geçici olarak kopyala ve görünmez yap
                const frameVisible = !canvasFrame.classList.contains('hidden');
                let frameStyle = null;
                
                if (frameVisible) {
                    frameStyle = canvasFrame.getAttribute('style');
                }
                
                // Kısa bir gecikme ekleyerek DOM'un güncellenmesini sağla
                setTimeout(() => {
                    progressBarFill.style.width = '30%';
                    
                    // Görüntüyü oluştur
                    html2canvas(canvasContainer, {
                        backgroundColor: null,
                        scale: 2,
                        useCORS: true,
                        allowTaint: true,
                        logging: false,
                        onclone: function(clonedDoc) {
                            // Klonlanmış DOM'da çerçeveyi görünür yap
                            const clonedFrame = clonedDoc.getElementById('canvas-frame');
                            if (frameVisible && clonedFrame) {
                                clonedFrame.style.visibility = 'visible';
                                clonedFrame.style.zIndex = '1'; // Çerçevenin üstte olduğundan emin ol
                            }
                        }
                    }).then(canvas => {
                        progressBarFill.style.width = '70%';
                        
                        // Orijinal çerçeve stilini geri yükle
                        if (frameVisible) {
                            canvasFrame.setAttribute('style', frameStyle);
                        }
                        
                        try {
                            // Canvas'ı bir veri URL'sine dönüştür
                            const imgData = canvas.toDataURL('image/png');
                            progressBarFill.style.width = '90%';
                            
                            // Önizleme modalında göster
                            previewImage.src = imgData;
                            previewModal.style.display = 'block';
                            
                            // Doğrudan indirme butonu
                            tryDirectDownloadBtn.onclick = function() {
                                try {
                                    const link = document.createElement('a');
                                    link.download = 'reklamingo_gorsel.png';
                                    link.href = imgData;
                                    document.body.appendChild(link);
                                    link.click();
                                    document.body.removeChild(link);
                                } catch (err) {
                                    alert('Doğrudan indirme başarısız oldu. Lütfen görsele sağ tıklayıp "Resmi Farklı Kaydet" seçeneğini kullanın.');
                                }
                            };
                            
                            progressBarFill.style.width = '100%';
                            
                            // İlk kullanımı işaretle
                            if (!usedFree) {
                                localStorage.setItem('usedFreeDesign', 'true');
                                usedFree = true;
                                checkUsageLimit();
                            }
                            
                            // İşlem tamamlandığında düğmeyi ve ilerleme çubuğunu sıfırla
                            setTimeout(() => {
                                downloadBtn.disabled = false;
                                downloadBtn.textContent = 'Görseli Oluştur';
                                downloadProgress.style.display = 'none';
                                progressBarFill.style.width = '0%';
                            }, 1000);
                            
                        } catch (error) {
                            console.error('Görsel oluşturma hatası:', error);
                            alert('Görsel oluşturulurken bir hata oluştu. Lütfen tekrar deneyin.');
                            downloadBtn.disabled = false;
                            downloadBtn.textContent = 'Görseli Oluştur';
                            downloadProgress.style.display = 'none';
                        }
                    }).catch(error => {
                        console.error('Canvas oluşturma hatası:', error);
                        alert('Görsel oluşturulurken bir hata oluştu. Lütfen tekrar deneyin.');
                        downloadBtn.disabled = false;
                        downloadBtn.textContent = 'Görseli Oluştur';
                        downloadProgress.style.display = 'none';
                    });
                }, 100);
            });
            
            // Sayfa yüklendiğinde kullanım sınırı kontrolü
            checkUsageLimit();
            
            // Modal dışına tıklandığında kapatma
            window.addEventListener('click', (e) => {
                if (e.target === codeModal) {
                    codeModal.style.display = 'none';
                }
                if (e.target === previewModal) {
                    previewModal.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
